#!/usr/bin/env ruby
# frozen_string_literal: true

require "bundler/setup"

# To run Rus3 in *debug mode*, pass any argument in the command line.
RUS3_DEBUG = !ARGV.shift.nil?
require "rus3"

# You can add fixtures and/or initialization code here to make experimenting
# with your gem easier. You can also use a different console, if you like.

class Scheme
  require "singleton"
  include Singleton
  include Rus3

  attr_reader :_

  def initialize
    @_ = nil
  end

  def e(code_string)
    @_ = self.eval(code_string)
  end

  def repl
    loop {
      begin
        print "> "
        code_string = STDIN.readline
      rescue EOFError => _
        break "Bye!"
      end
      e(code_string)
      puts "==> #{@_}"
    }
  end
end

# (If you use this, don't forget to add pry to your Gemfile!)
# require "pry"
# Pry.start

require "irb"
IRB.start(__FILE__)
